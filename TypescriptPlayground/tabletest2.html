<html xmlns="http://www.w3.org/1999/xhtml" >

<head runat="server">

<title>Dynamic Table</title>

<script language="javascript" type="text/javascript">

    // <!CDATA[

    function CmdAdd_onclick()
    {
        var newTable,startTag,endTag;

        //Creating a new table
        startTag="<TABLE id='mainTable'><TBODY><TR><TD style=\"WIDTH: 120px\">User ID</TD><TD style=\"WIDTH: 120px\">User Name</TD><TD style=\"WIDTH: 120px\">Department</TD></TR>"
        endTag="</TBODY></TABLE>"

        newTable=startTag;

        var trContents;

        //Get the row contents

        trContents=document.body.getElementsByTagName('TR');

        if(trContents.length>1)
        {
            for(i=1;i<trContents.length;i++)
            {
                if(trContents(i).innerHTML)
                {
                    // Add previous rows
                    newTable+="<TR>";
                    newTable+=trContents(i).innerHTML;
                    newTable+="</TR>";
                } 
            }
        }

        //Add the Latest row
        newTable+="<TR><TD style=\"WIDTH: 120px\" >" +
            document.getElementById('userid').value +"</TD>";

        newTable+="<TD style=\"WIDTH: 120px\" >" +
            document.getElementById('username').value +"</TD>";

        newTable+="<TD style=\"WIDTH: 120px\" >" +
            document.getElementById('department').value +"</TD><TR>";

        newTable+=endTag;

        //Update the Previous Table With New Table.
        document.getElementById('tableDiv').innerHTML=newTable;
    }
    // ]]>

    var initialData = [{ uid: "bp", name: "brad", dept: "engineering", checkbox: true },
                         { uid: "sl", name: "susan", dept: "law", checkbox: false },
                         { uid: "fmp", name: "frank", dept: "science", checkbox: true },
                         { uid: "sjp", name: "sadie", dept: "math", checkbox: false }];

    //
    // Used to configure checkbox with "checked" if data is checked
    //
    function isChecked(data, row)
    {
        if (data[row].checkbox == true)
            return "checked";
        else
            return "";
    }

    function CmdInit_onclick() {
        var newTable, startTag, endTag;

        //Creating a new table
        startTag = "<TABLE id='mainTable'><TBODY><TR><TD style=\"WIDTH: 120px\">User ID</TD><TD style=\"WIDTH: 120px\">User Name</TD><TD style=\"WIDTH: 120px\">Department</TD><TD style=\"WIDTH: 120px\">Select</TD></TR>"
        endTag = "</TBODY></TABLE>"

        newTable = startTag;

        var trContents;

        //Get the row contents

        trContents = document.body.getElementsByTagName('TR');

        if (trContents.length > 1) {
            for (i = 1; i < trContents.length; i++) {
                if (trContents(i).innerHTML) {
                    // Add previous rows
                    newTable += "<TR>";
                    newTable += trContents(i).innerHTML;
                    newTable += "</TR>";
                }
            }
        }

        for (i = 0; i < initialData.length; i++)
        {
            //Add the Latest row
            newTable += "<TR id=" + i + "><TD style=\"WIDTH: 120px\" >" +
                initialData[i].uid + "</TD>";

            newTable += "<TD style=\"WIDTH: 120px\" >" +
                initialData[i].name + "</TD>";

            newTable += "<TD style=\"WIDTH: 120px\" >" +
                initialData[i].dept + "</TD>";

            newTable += "<TD style=\"WIDTH: 120px\" >" + "<input type=\"checkbox\" " + isChecked( initialData, i ) + " onclick=\"return cmd_checkbox(this)\">" + "</TD><TR>";
        }

        newTable += endTag;

        //Update the Previous Table With New Table.
        document.getElementById('tableDiv').innerHTML = newTable;
    }

    function cmd_checkbox(chk_row)
    {
        // Move up to the row since we are in the check_box element
        var row = chk_row.parentNode.parentNode;

        console.log("found row: ", row.id);
        console.log("row uid: ", initialData[parseInt(row.id, 10)].uid);

    }

</script>

<style>
table
{
border-collapse:collapse;
}

table,th,td
{
border:1px solid black;
color: green
}
</style>

</head>

<body>

<form id="form1" runat="server">

<div>

<br />

<label>UserID</label> 

<input id="userid" type="text" /><br />

<label>UserName</label> 

<input id="username" type="text" /><br />

<label>Department</label> 

<input id="department" type="text" />

</div>

<div>
<center>

<input id="CmdAdd" type="button" value="Add" onclick="return CmdAdd_onclick()" />
<input id="CmdInit" type="button" value="Init" onclick="return CmdInit_onclick()" />
<input type="checkbox" name="testCheckB"/>

</center>
</div>

<div id="tableDiv" style="text-align:center" >

<table id="mainTable">

<tr style="width:120px " >

<td >User ID</td>

<td>User Name</td>

<td>Department</td>

<td>Select</td>
</tr>

</table>

</div>

</form>

</body>

</html>
